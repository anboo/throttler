# Принцип работы
![Throttler](https://user-images.githubusercontent.com/7625387/210429206-c806da7f-7f9e-4335-b448-c9fe4abdde96.png)

# Запуск
Make:
```
make go-run #через локальный go
make docker-run #через docker-compose
```
Вручную через docker-compose:
```
HTTP_PORT=9000 POSTGRESQL_PORT=5432 docker-compose up --build
```

# Конфигурация
|               Переменная               | Описание                                   | Значение по умолчанию                                                                                                                                                                                          |
|:--------------------------------------:|--------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| DB_DSN                                 | Адрес базы данных, `in-memory://` либо DSN | Нет                                                                                                                                                                                                            |
| RATE_LIMIT_STRATEGY                    | realtime                                   | linear - все запросы будут выполнены равномерно с одинаковым rate ожидания между запросами, даже если интервал времени уже прошел. realtime - все запросы будут выполняться сразу же, пока не упрутся в лимит. |
| RATE_LIMIT_REQUESTS_LIMIT_PER_INTERVAL | 1m                                         | Формат time.Duration. Указывается интервал для лимитированного кол-ва запросов.                                                                                                                                |
| RATE_LIMIT_REQUESTS_INTERVAL           | 100                                        | Максимальное кол-во запросов за указанный интервал.                                                                                                                                                            |
| QUEUE_INTERVAL_CHECKING_NEW_REQUESTS   | 1s                                         | Формат time.Duration. Указывается интервал опроса базы данных очередью, обрабатывающую поступающие запросы.                                                                                                    |
| QUEUE_WORKERS_SIZE                     | `runtime.GOMAXPROCS(0)`                    | Кол-во горутин, которые будут запущены для разбора очереди из бд                                                                                                                                               |